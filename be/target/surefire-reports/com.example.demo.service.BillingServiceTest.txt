-------------------------------------------------------------------------------
Test set: com.example.demo.service.BillingServiceTest
-------------------------------------------------------------------------------
Tests run: 5, Failures: 3, Errors: 2, Skipped: 0, Time elapsed: 1.105 s <<< FAILURE! -- in com.example.demo.service.BillingServiceTest
com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldThrowException_WhenInvalidSignature -- Time elapsed: 0.712 s <<< FAILURE!
java.lang.AssertionError: 

Expecting actual throwable to be an instance of:
  java.lang.RuntimeException
but was:
  com.stripe.exception.SignatureVerificationException: Invalid signature
	at com.stripe.net.Webhook.constructEvent(Webhook.java:32)
	at com.example.demo.service.BillingService.handleStripeWebhook(BillingService.java:91)
	at com.example.demo.service.BillingServiceTest.lambda$1(BillingServiceTest.java:71)
	...(79 remaining lines not displayed - this can be changed with Assertions.setMaxStackTraceElementsDisplayed)
	at com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldThrowException_WhenInvalidSignature(BillingServiceTest.java:72)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)

com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldHandleUnhandledEventType_WithoutError -- Time elapsed: 0.188 s <<< FAILURE!
org.mockito.exceptions.verification.TooManyActualInvocations: 

event.getType();
Wanted 1 time:
-> at com.stripe.model.Event.getType(Event.java:207)
But was 3 times:
-> at com.example.demo.service.BillingService.handleStripeEvent(BillingService.java:97)
-> at com.example.demo.service.BillingService.handleStripeEvent(BillingService.java:99)
-> at com.example.demo.service.BillingService.handleStripeEvent(BillingService.java:106)


	at com.stripe.model.Event.getType(Event.java:207)
	at com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldHandleUnhandledEventType_WithoutError(BillingServiceTest.java:190)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)

com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldHandleSubscriptionCreated_WhenValidEvent -- Time elapsed: 0.084 s <<< ERROR!
java.lang.NullPointerException: Cannot invoke "Object.getClass()" because the return value of "com.stripe.model.Event.getDataObjectDeserializer()" is null
	at com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldHandleSubscriptionCreated_WhenValidEvent(BillingServiceTest.java:154)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)

com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldCreateSubscription_WhenCheckoutSessionCompleted -- Time elapsed: 0.061 s <<< ERROR!
java.lang.NullPointerException: Cannot invoke "Object.getClass()" because the return value of "com.stripe.model.Event.getDataObjectDeserializer()" is null
	at com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldCreateSubscription_WhenCheckoutSessionCompleted(BillingServiceTest.java:122)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)

com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldProcessCheckoutSessionCompleted_WhenValidSignature -- Time elapsed: 0.029 s <<< FAILURE!
org.mockito.exceptions.verification.TooManyActualInvocations: 

event.getType();
Wanted 1 time:
-> at com.stripe.model.Event.getType(Event.java:207)
But was 2 times:
-> at com.example.demo.service.BillingService.handleStripeEvent(BillingService.java:97)
-> at com.example.demo.service.BillingService.handleStripeEvent(BillingService.java:99)


	at com.stripe.model.Event.getType(Event.java:207)
	at com.example.demo.service.BillingServiceTest.handleStripeWebhook_ShouldProcessCheckoutSessionCompleted_WhenValidSignature(BillingServiceTest.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:565)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1604)

